---
title: 设计表时遇到的坑
date: 2020-11-02 21:32:36
tags:
---

# 设计表时遇到的坑

​		当我们设计表的时候，一定会遇到各种问题。

## 		坑一：

​		当我们设计删除的时候，必须要考虑删除所造成的的后果。因此，我们在设计删除的时候，一定要设计成逻辑删除。

​		什么叫逻辑删除，逻辑删除只需要在表后添加一个`is_delete`的字段，将它默认为`False`，每当我们要删除时，就将该字段修改为`True`就OK。

​		为什么要这样设计。我们设想一个情景，当某用户想要删除订单，假设他已经提交删除了，但是过了一会，他又反悔了，不想删了。那我们就想，如果用物理删除，那么这个订单是不是就永久删除了，数据库的持久性，事务已经提交就无法返回了。遇到这种情况，我们总不可能和用户说，世界上没有后悔药吧。

​		所以为了考虑到用户体验，我们使用逻辑删除，只需要修改订单的状态，或者修改`is_delete`是不是就OK了，互联网经过这么长时间的更新，现在也没有公司会考虑使用物理删除。

## 		坑二:

​		外键这个东西,每个程序猿肯定都知道，删除有物流删除逻辑删除，那么外键也有物理外键和逻辑外键。

​		当我们用物理外键的时候，数据库中的数据就会被外键锁死，那我们以后需要修改数据库或更新数据库的时候，是不是很麻烦。如果我们使用逻辑外键，只需要添加字段和数据，不需要添加ForeignKey，也可以通过外键的字段进行查询，并且这样数据就是活的，在我们迁移或者修改数据表的时候，就方便了很多。